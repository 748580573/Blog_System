<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="shortcut icon" href="favicon.ico">
    <link href="css/bootstrap.min.css-v=3.3.5.css" rel="stylesheet">
    <link href="css/font-awesome.min.css-v=4.4.0.css"  rel="stylesheet">
    <link href="css/plugins/iCheck/custom.css"  rel="stylesheet">
    <link href="css/animate.min.css"  rel="stylesheet">
    <link href="css/style.min.css-v=4.0.0.css"  rel="stylesheet"><base target="_blank">
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/fileinput.css">


    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/bootstrap.js"></script>
    <script src="js/fileinput.js"></script>

    <!-- include summernote css/js -->
    <link href="http://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.11/summernote.css" rel="stylesheet">
    <script src="../hplus/js/summernote.js"></script>
    <script src="../hplus/js/summernote-zh-CN.js"></script>

    <style type="text/css">
        .label:hover{
            cursor: pointer;
        }

        .tags{
            float: left;
            margin-right: 10px;
            margin-bottom: 15px
        }

        #blog_tags{
            color: #0e9aef;
        }

        #uploadfile{
            opacity: 0;
        }


    </style>
</head>
<body>

<div class="wrapper wrapper-content animated fadeInRight">
    <div class="row">
        <div class="col-sm-12">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <form id="fm" method="get" class="form-horizontal" enctype="multipart/form-data">
                        <div class="form-group">
                            <label class="col-sm-2 control-label">博客标题</label>

                            <div class="col-sm-8">
                                <input id="blog_title" type="text" name="blog_title" placeholder="博客标题" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>

                        <div class="form-group">
                            <label class="col-sm-2 control-label">简介</label>

                            <div class="col-sm-8">
                                <input id="blog_desc" type="text" name="blog_desc"  placeholder="简要描述博客，突出自我个性" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">博客封面</label>
                            <div class="col-sm-8">
                                <input id="uploadfile" name="blog_conver" type="file">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>


                        <div class="form-group">
                            <label class="col-sm-2 control-label">标签</label>

                            <div class="col-sm-8">
                                <input id="blog_tags" name="bolg_tags" type="text" placeholder="博客标签(以空格区分开)" class="form-control">
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>

                        <div class="wrapper wrapper-content animated fadeInRight" style="margin-left: 20%;">
                            <div class="row">
                                <div class="col-sm-8">
                                    <div class="ibox float-e-margins">
                                        <div class="ibox-title">
                                            <h5>可选标签标签</h5>
                                        </div>
                                        <div class="ibox-content">
                                            <p>
                                                <span class="label label-primary tags" onclick="getTag(this)"></span>
                                            </p>

                                            <p><span class="label label-primary tags" onclick="getTag(this)">label-primary</span>
                                            </p>
                                            <p><span class="label label-info tags" onclick="getTag(this)">label-info</span>
                                            </p>
                                            <p><span class="label label-success tags" onclick="getTag(this)">label-success</span>
                                            </p>
                                            <p><span class="label label-warning tags" onclick="getTag(this)">label-warning</span>
                                            </p>
                                            <p><span class="label label-danger tags" onclick="getTag(this)">label-danger</span>
                                            </p>

                                            <p><span class="label label-primary tags" onclick="getTag(this)">label-primary</span>
                                            </p>
                                            <p><span class="label label-info tags" onclick="getTag(this)">label-info</span>
                                            </p>
                                            <p><span class="label label-success tags" onclick="getTag(this)">label-success</span>
                                            </p>
                                            <p><span class="label label-warning tags" onclick="getTag(this)">label-warning</span>
                                            </p>
                                            <p><span class="label label-danger tags " onclick="getTag(this)">label-danger</span>
                                            </p>

                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>

                        <div class="hr-line-dashed"></div>

                    </form>
                </div>
            </div>
        </div>
    </div>
</div>


<div style="margin-left: 10%">
    <div id="summernote" >summernote 1</div>
</div>


<div class="html"></div>
<button id="but" onclick="sub_form()">点我</button>

</body>

<script>
    $(document).ready(function() {
        $("#summernote").summernote({
            height:500,
            width:1400,
            callbacks: {
                onImageUpload: function(files) {
                    alert("hello")
                    // upload image to server and create imgNode...
                }
            }
        });

        $("#uploadfile").fileinput({
            language:'zh',
            uploadUrl:"/blog_system/blog/uploadFile",
            allowedFileExtensions: ['jpg', 'gif', 'png'],
            uploadAsync: true,
            showPreview :true, //是否显示预览
            showUpload:false,
            showCaption:false,//是否显示标题
            browseClass:"btn btn-primary", //按钮样式    
            dropZoneEnabled: false,//是否显示拖拽区域
            minImageWidth: 1, //图片的最小宽度
            minImageHeight: 1,//图片的最小高度
            maxImageWidth: 1000,//图片的最大宽度
            maxImageHeight: 1000,//图片的最大高度
            maxFileSize:0,//单位为kb，如果为0表示不限制文件大小
            maxFileCount:1, //表示允许同时上传的最大文件个数
            enctype:'multipart/form-data',
            validateInitialCount:true,
            previewFileIcon: "<iclass='glyphicon glyphicon-king'></i>",
            msgFilesTooMany: "选择上传的文件数量({n}) 超过允许的最大数值{m}！",
        });

    });

    var imgUrl;
    var sub_form = function () {
        $("#uploadfile").fileinput("upload");
        $("#uploadfile").on("fileuploaded", function(event, data, previewId, index) {
            var aaa = data["response"][0];
            imgUrl = data["response"][0];

        });

        var blog_title = $("#blog_title").val();
        var blog_desc = $("#blog_desc").val();
        var bolg_tags = $("#blog_tags").val();
        var blog_content = $("#summernote").summernote("code");


        $.ajax({
            url:"/blog_system//blog/editBlog",
            type:"POST",
            data:{"blog_title":blog_title,"blog_desc":blog_desc,"bolg_tags":bolg_tags,
                "blog_content":blog_content,"imgUrl":imgUrl},
            success:function () {
            }
        })
    };

    var getTag = function (obj) {
        var text = $(obj).text();
        var val = $("#blog_tags").val();
        var newValue = val +" " + text;
        $("#blog_tags").val(newValue);
    }


</script>
</html>